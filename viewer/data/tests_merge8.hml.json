{"syntax":"<div class=\"highlight\"><pre><span class=\"n\">data</span> <span class=\"kt\">bool</span> <span class=\"o\">=</span> <span class=\"nc\">True</span> <span class=\"o\">|</span> <span class=\"nc\">False</span>\n\n<span class=\"n\">abstract</span> <span class=\"kt\">int</span>\n<span class=\"n\">fact</span> <span class=\"n\">duplicable</span> <span class=\"kt\">int</span>\n\n<span class=\"n\">data</span> <span class=\"n\">v</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"nc\">A</span> <span class=\"o\">{</span> <span class=\"n\">a</span><span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"o\">}</span> <span class=\"o\">|</span> <span class=\"nc\">B</span> <span class=\"o\">{</span> <span class=\"n\">b</span><span class=\"o\">:</span> <span class=\"n\">b</span> <span class=\"o\">}</span> <span class=\"o\">|</span> <span class=\"nc\">C</span> <span class=\"o\">|</span> <span class=\"nc\">D</span>\n\n<span class=\"c\">(* Cet exemple oblige à avoir une opération de soustraction avec des flexibles à</span>\n<span class=\"c\">   gauche et à droite. Comme on travaille avec des types duplicables, deux</span>\n<span class=\"c\">   permissions seront disponibles pour [v6]. On aura de même une soustraction</span>\n<span class=\"c\">   avec des flexibles si l&#39;on fait :</span>\n\n<span class=\"c\">   data list&#39; a = Nil | Nil&#39; | Cons { ... }</span>\n<span class=\"c\">   val x = length (if True then Nil else Nil&#39;)</span>\n\n<span class=\"c\">   parce que la soustraction fera list a* - list b* avec a* et b* flexibles.</span>\n<span class=\"c\">   Dans ce cas-là, la bonne réponse est d&#39;unifier, et d&#39;accepter l&#39;argument.</span>\n<span class=\"c\">   Dans l&#39;exemple avec [v6], on exerce en plus le cas dans [merge_types] où l&#39;on</span>\n<span class=\"c\">   a des flexibles des deux côtés, et qu&#39;on doit merger ça en une même flexible</span>\n<span class=\"c\">   dans l&#39;environnement de destination. Tout ça pour obtenir :</span>\n\n<span class=\"c\">   v8 @ ∀ab. v a b ∗ v6 @ ∀a. v a a</span>\n<span class=\"c\">*)</span>\n<span class=\"k\">val</span> <span class=\"o\">(</span><span class=\"n\">v8</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">]</span> <span class=\"n\">v</span> <span class=\"n\">a</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"o\">=</span>\n  <span class=\"k\">if</span> <span class=\"n\">explain</span> <span class=\"nc\">True</span> <span class=\"k\">then</span>\n    <span class=\"nc\">D</span>\n  <span class=\"k\">else</span>\n    <span class=\"nc\">C</span>\n</pre></div>\n","current_location":{"start":{"line":24,"col":21},"end":{"line":28,"col":5}},"file_name":"tests/merge8.hml","type":"merge","merged_env":{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"306pt\" height=\"60pt\"\n viewBox=\"0.00 0.00 306.00 60.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 56)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-56 303,-56 303,5 -4,5\"/>\n<!-- node4 -->\n<g id=\"node4\" class=\"node\"><title>node4</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 54,-44 54,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"27\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node5 -->\n<g id=\"node5\" class=\"node\"><title>node5</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"71.5,-8 71.5,-44 198.5,-44 198.5,-8 71.5,-8\"/>\n<text text-anchor=\"middle\" x=\"135\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">[g5, g4] v g4 g5</text>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"216,-1 216,-51 298,-51 298,-1 216,-1\"/>\n<text text-anchor=\"middle\" x=\"257\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"216,-26 298,-26 \"/>\n<text text-anchor=\"middle\" x=\"257\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v8</text>\n</g>\n</g>\n</svg>\n","root":5,"points":{"3":{"names":[["user","v8"]],"locations":[{"start":{"line":24,"col":5},"end":{"line":24,"col":7}}],"kind":"term","permissions":["=v8"]},"5":{"names":[["auto","merge_root3"]],"locations":[{"start":{"line":24,"col":21},"end":{"line":28,"col":5}}],"kind":"term","permissions":["=merge_root3","[g5, g4] v g4 g5"]},"4":{"names":[["auto","v8_if"]],"locations":[{"start":{"line":25,"col":12},"end":{"line":25,"col":18}}],"kind":"term","permissions":["=v8_if","True"]}}},"sub_envs":[{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"234pt\" height=\"60pt\"\n viewBox=\"0.00 0.00 234.00 60.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 56)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-56 231,-56 231,5 -4,5\"/>\n<!-- node4 -->\n<g id=\"node4\" class=\"node\"><title>node4</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 54,-44 54,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"27\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node5 -->\n<g id=\"node5\" class=\"node\"><title>node5</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"72,-8 72,-44 126,-44 126,-8 72,-8\"/>\n<text text-anchor=\"middle\" x=\"99\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">D</text>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"144,-1 144,-51 226,-51 226,-1 144,-1\"/>\n<text text-anchor=\"middle\" x=\"185\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"144,-26 226,-26 \"/>\n<text text-anchor=\"middle\" x=\"185\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v8</text>\n</g>\n</g>\n</svg>\n","root":5,"points":{"3":{"names":[["user","v8"]],"locations":[{"start":{"line":24,"col":5},"end":{"line":24,"col":7}}],"kind":"term","permissions":["=v8"]},"5":{"names":[["auto","v8_then"]],"locations":[{"start":{"line":26,"col":4},"end":{"line":26,"col":5}}],"kind":"term","permissions":["D","=v8_then"]},"4":{"names":[["auto","v8_if"]],"locations":[{"start":{"line":25,"col":12},"end":{"line":25,"col":18}}],"kind":"term","permissions":["True","=v8_if"]}}},{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"234pt\" height=\"60pt\"\n viewBox=\"0.00 0.00 234.00 60.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 56)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-56 231,-56 231,5 -4,5\"/>\n<!-- node4 -->\n<g id=\"node4\" class=\"node\"><title>node4</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 54,-44 54,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"27\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node5 -->\n<g id=\"node5\" class=\"node\"><title>node5</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"72,-8 72,-44 126,-44 126,-8 72,-8\"/>\n<text text-anchor=\"middle\" x=\"99\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">C</text>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"144,-1 144,-51 226,-51 226,-1 144,-1\"/>\n<text text-anchor=\"middle\" x=\"185\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"144,-26 226,-26 \"/>\n<text text-anchor=\"middle\" x=\"185\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v8</text>\n</g>\n</g>\n</svg>\n","root":5,"points":{"3":{"names":[["user","v8"]],"locations":[{"start":{"line":24,"col":5},"end":{"line":24,"col":7}}],"kind":"term","permissions":["=v8"]},"5":{"names":[["auto","v8_else"]],"locations":[{"start":{"line":28,"col":4},"end":{"line":28,"col":5}}],"kind":"term","permissions":["C","=v8_else"]},"4":{"names":[["auto","v8_if"]],"locations":[{"start":{"line":25,"col":12},"end":{"line":25,"col":18}}],"kind":"term","permissions":["True","=v8_if"]}}}]}