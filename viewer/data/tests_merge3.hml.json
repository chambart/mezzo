{"syntax":"<div class=\"highlight\"><pre><span class=\"n\">data</span> <span class=\"kt\">bool</span> <span class=\"o\">=</span> <span class=\"nc\">True</span> <span class=\"o\">|</span> <span class=\"nc\">False</span>\n\n<span class=\"n\">data</span> <span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"nc\">T</span>\n<span class=\"n\">data</span> <span class=\"n\">u</span> <span class=\"o\">=</span> <span class=\"nc\">U</span> <span class=\"o\">{</span> <span class=\"n\">left</span><span class=\"o\">:</span> <span class=\"n\">t</span><span class=\"o\">;</span> <span class=\"n\">right</span><span class=\"o\">:</span> <span class=\"n\">t</span> <span class=\"o\">}</span>\n\n<span class=\"c\">(* Un exemple encore plus compliqué, où il y a du partage d&#39;un côté mais pas de</span>\n<span class=\"c\">   l&#39;autre. Il est quand même possible d&#39;obtenir une bonne permission en sortie</span>\n<span class=\"c\">   pour le résultat de ce if, car le type [t] est duplicable ce qui permet</span>\n<span class=\"c\">   d&#39;utiliser (à gauche) [x @ T] deux fois. On obtient</span>\n\n<span class=\"c\">   ∃(?, ?&#39; :: TERM). v3 @ U { left = ?; right = ?&#39; } ∗ ? @ T ∗ ?&#39; @ T</span>\n\n<span class=\"c\">   À noter qu&#39;on ne peut plus obtenir [v3 @ u] si jamais l&#39;on déclare [t] comme</span>\n<span class=\"c\">   étant exclusif.</span>\n<span class=\"c\">*)</span>\n<span class=\"k\">val</span> <span class=\"n\">v3</span> <span class=\"o\">=</span>\n  <span class=\"k\">let</span> <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"nc\">T</span> <span class=\"k\">in</span>\n  <span class=\"k\">if</span> <span class=\"n\">explain</span> <span class=\"nc\">True</span> <span class=\"k\">then</span> <span class=\"k\">begin</span>\n    <span class=\"nc\">U</span> <span class=\"o\">{</span> <span class=\"n\">left</span> <span class=\"o\">=</span> <span class=\"n\">x</span><span class=\"o\">;</span> <span class=\"n\">right</span> <span class=\"o\">=</span> <span class=\"n\">x</span> <span class=\"o\">}</span>\n  <span class=\"k\">end</span> <span class=\"k\">else</span> <span class=\"k\">begin</span>\n    <span class=\"k\">let</span> <span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"nc\">T</span> <span class=\"k\">in</span>\n    <span class=\"nc\">U</span> <span class=\"o\">{</span> <span class=\"n\">left</span> <span class=\"o\">=</span> <span class=\"n\">x</span><span class=\"o\">;</span> <span class=\"n\">right</span> <span class=\"o\">=</span> <span class=\"n\">y</span> <span class=\"o\">}</span>\n  <span class=\"k\">end</span>\n</pre></div>\n","current_location":{"start":{"line":17,"col":14},"end":{"line":23,"col":5}},"file_name":"tests/merge3.hml","type":"merge","merged_env":{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"296pt\" height=\"148pt\"\n viewBox=\"0.00 0.00 296.00 148.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 144)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-144 293,-144 293,5 -4,5\"/>\n<!-- node8 -->\n<g id=\"node8\" class=\"node\"><title>node8</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"6,-89 6,-139 60,-139 60,-89 6,-89\"/>\n<text text-anchor=\"middle\" x=\"33\" y=\"-122.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"6,-114 60,-114 \"/>\n<text text-anchor=\"middle\" x=\"33\" y=\"-97.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">x</text>\n</g>\n<!-- node6 -->\n<g id=\"node6\" class=\"node\"><title>node6</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"134,-8 134,-44 188,-44 188,-8 134,-8\"/>\n<text text-anchor=\"middle\" x=\"161\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node9 -->\n<g id=\"node9\" class=\"node\"><title>node9</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"78,-96 78,-132 132,-132 132,-96 78,-96\"/>\n<text text-anchor=\"middle\" x=\"105\" y=\"-109.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"206,-1 206,-51 288,-51 288,-1 206,-1\"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"206,-26 288,-26 \"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v3</text>\n</g>\n<!-- node7 -->\n<g id=\"node7\" class=\"node\"><title>node7</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 116,-44 116,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"13.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">U</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"27,-8 27,-44 \"/>\n<text text-anchor=\"middle\" x=\"46.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">left</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"66,-8 66,-44 \"/>\n<text text-anchor=\"middle\" x=\"91\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">right</text>\n</g>\n<!-- node7&#45;&gt;node8 -->\n<g id=\"edge2\" class=\"edge\"><title>node7:left&#45;&gt;node8</title>\n<path fill=\"none\" stroke=\"black\" d=\"M46,-44C46,-55.5455 44.2693,-67.9849 42.0709,-79.1288\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"38.6427,-78.4229 39.9567,-88.9359 45.4856,-79.8981 38.6427,-78.4229\"/>\n</g>\n<!-- node7&#45;&gt;node9 -->\n<g id=\"edge4\" class=\"edge\"><title>node7:right&#45;&gt;node9</title>\n<path fill=\"none\" stroke=\"black\" d=\"M91,-44C91,-57.9426 93.7037,-73.1493 96.7347,-85.8165\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"93.4173,-86.9684 99.3057,-95.7762 100.195,-85.2187 93.4173,-86.9684\"/>\n</g>\n</g>\n</svg>\n","root":7,"points":{"7":{"names":[["auto","merge_root9"]],"locations":[{"start":{"line":17,"col":14},"end":{"line":23,"col":5}}],"kind":"term","permissions":["=merge_root9","U {\n    left: =merge_point10;\n    right: =merge_point11\n  }"]},"3":{"names":[["user","v3"]],"locations":[{"start":{"line":16,"col":4},"end":{"line":16,"col":7}}],"kind":"term","permissions":["=v3"]},"9":{"names":[["auto","merge_point11"]],"locations":[{"start":{"line":21,"col":16},"end":{"line":22,"col":29}},{"start":{"line":18,"col":28},"end":{"line":20,"col":2}}],"kind":"term","permissions":["=merge_point11","T"]},"6":{"names":[["auto","/x_1"]],"locations":[{"start":{"line":18,"col":12},"end":{"line":18,"col":18}}],"kind":"term","permissions":["=/x_1","True"]},"8":{"names":[["auto","merge_point10"],["user","x"]],"locations":[{"start":{"line":18,"col":28},"end":{"line":20,"col":2}},{"start":{"line":21,"col":16},"end":{"line":22,"col":29}},{"start":{"line":17,"col":6},"end":{"line":17,"col":8}},{"start":{"line":17,"col":9},"end":{"line":17,"col":11}}],"kind":"term","permissions":["T","=merge_point10"]}},"dot":"digraph g {\ngraph [\n  rankdir = \"BT\"\n];\n\"node8\" [\n  id = \"node8\"\n  label = \"{{T}|x}\"\n  shape = \"record\"\n];\n\"node9\" [\n  id = \"node9\"\n  label = \"T\"\n  shape = \"record\"\n];\n\"node7\":left -> \"node8\" [\n];\n\"node7\":right -> \"node9\" [\n];\n\"node7\" [\n  id = \"node7\"\n  label = \"U|<left>left|<right>right\"\n  shape = \"record\"\n];\n}"},"sub_envs":[{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"296pt\" height=\"148pt\"\n viewBox=\"0.00 0.00 296.00 148.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 144)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-144 293,-144 293,5 -4,5\"/>\n<!-- node6 -->\n<g id=\"node6\" class=\"node\"><title>node6</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 54,-44 54,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"27\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node5 -->\n<g id=\"node5\" class=\"node\"><title>node5</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"113,-89 113,-139 167,-139 167,-89 113,-89\"/>\n<text text-anchor=\"middle\" x=\"140\" y=\"-122.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"113,-114 167,-114 \"/>\n<text text-anchor=\"middle\" x=\"140\" y=\"-97.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">x</text>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"206,-1 206,-51 288,-51 288,-1 206,-1\"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"206,-26 288,-26 \"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v3</text>\n</g>\n<!-- node7 -->\n<g id=\"node7\" class=\"node\"><title>node7</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"72,-8 72,-44 188,-44 188,-8 72,-8\"/>\n<text text-anchor=\"middle\" x=\"85.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">U</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"99,-8 99,-44 \"/>\n<text text-anchor=\"middle\" x=\"118.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">left</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"138,-8 138,-44 \"/>\n<text text-anchor=\"middle\" x=\"163\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">right</text>\n</g>\n<!-- node7&#45;&gt;node5 -->\n<g id=\"edge2\" class=\"edge\"><title>node7:left&#45;&gt;node5</title>\n<path fill=\"none\" stroke=\"black\" d=\"M118,-44C118,-55.8013 120.881,-68.2283 124.558,-79.2826\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"121.384,-80.7957 128.099,-88.9913 127.96,-78.3973 121.384,-80.7957\"/>\n</g>\n<!-- node7&#45;&gt;node5 -->\n<g id=\"edge4\" class=\"edge\"><title>node7:right&#45;&gt;node5</title>\n<path fill=\"none\" stroke=\"black\" d=\"M163,-44C163,-55.7526 160.038,-68.0855 156.239,-79.0684\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"152.852,-78.1286 152.577,-88.7199 159.397,-80.6121 152.852,-78.1286\"/>\n</g>\n</g>\n</svg>\n","root":7,"points":{"7":{"names":[["auto","/x_2"]],"locations":[{"start":{"line":18,"col":28},"end":{"line":20,"col":2}}],"kind":"term","permissions":["U {\n    left: =x;\n    right: =x\n  }","=/x_2"]},"3":{"names":[["user","v3"]],"locations":[{"start":{"line":16,"col":4},"end":{"line":16,"col":7}}],"kind":"term","permissions":["=v3"]},"5":{"names":[["user","x"]],"locations":[{"start":{"line":17,"col":9},"end":{"line":17,"col":11}},{"start":{"line":17,"col":6},"end":{"line":17,"col":8}}],"kind":"term","permissions":["T","=x"]},"6":{"names":[["auto","/x_1"]],"locations":[{"start":{"line":18,"col":12},"end":{"line":18,"col":18}}],"kind":"term","permissions":["True","=/x_1"]}},"dot":"digraph g {\ngraph [\n  rankdir = \"BT\"\n];\n\"node5\" [\n  id = \"node5\"\n  label = \"{{T}|x}\"\n  shape = \"record\"\n];\n\"node7\":left -> \"node5\" [\n];\n\"node7\":right -> \"node5\" [\n];\n\"node7\" [\n  id = \"node7\"\n  label = \"U|<left>left|<right>right\"\n  shape = \"record\"\n];\n}"},{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"296pt\" height=\"148pt\"\n viewBox=\"0.00 0.00 296.00 148.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 144)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-144 293,-144 293,5 -4,5\"/>\n<!-- node8 -->\n<g id=\"node8\" class=\"node\"><title>node8</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"78,-89 78,-139 132,-139 132,-89 78,-89\"/>\n<text text-anchor=\"middle\" x=\"105\" y=\"-122.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"78,-114 132,-114 \"/>\n<text text-anchor=\"middle\" x=\"105\" y=\"-97.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">y</text>\n</g>\n<!-- node6 -->\n<g id=\"node6\" class=\"node\"><title>node6</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"134,-8 134,-44 188,-44 188,-8 134,-8\"/>\n<text text-anchor=\"middle\" x=\"161\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node9 -->\n<g id=\"node9\" class=\"node\"><title>node9</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 116,-44 116,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"13.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">U</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"27,-8 27,-44 \"/>\n<text text-anchor=\"middle\" x=\"46.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">left</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"66,-8 66,-44 \"/>\n<text text-anchor=\"middle\" x=\"91\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">right</text>\n</g>\n<!-- node9&#45;&gt;node8 -->\n<g id=\"edge4\" class=\"edge\"><title>node9:right&#45;&gt;node8</title>\n<path fill=\"none\" stroke=\"black\" d=\"M91,-44C91,-55.5763 92.8638,-68.0239 95.2313,-79.1659\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"91.8365,-80.0201 97.5082,-88.9689 98.655,-78.4363 91.8365,-80.0201\"/>\n</g>\n<!-- node5 -->\n<g id=\"node5\" class=\"node\"><title>node5</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"6,-89 6,-139 60,-139 60,-89 6,-89\"/>\n<text text-anchor=\"middle\" x=\"33\" y=\"-122.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"6,-114 60,-114 \"/>\n<text text-anchor=\"middle\" x=\"33\" y=\"-97.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">x</text>\n</g>\n<!-- node9&#45;&gt;node5 -->\n<g id=\"edge2\" class=\"edge\"><title>node9:left&#45;&gt;node5</title>\n<path fill=\"none\" stroke=\"black\" d=\"M46,-44C46,-55.5455 44.2693,-67.9849 42.0709,-79.1288\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"38.6427,-78.4229 39.9567,-88.9359 45.4856,-79.8981 38.6427,-78.4229\"/>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"206,-1 206,-51 288,-51 288,-1 206,-1\"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"206,-26 288,-26 \"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v3</text>\n</g>\n</g>\n</svg>\n","root":9,"points":{"3":{"names":[["user","v3"]],"locations":[{"start":{"line":16,"col":4},"end":{"line":16,"col":7}}],"kind":"term","permissions":["=v3"]},"5":{"names":[["user","x"]],"locations":[{"start":{"line":17,"col":9},"end":{"line":17,"col":11}},{"start":{"line":17,"col":6},"end":{"line":17,"col":8}}],"kind":"term","permissions":["T","=x"]},"9":{"names":[["auto","/x_6"]],"locations":[{"start":{"line":21,"col":16},"end":{"line":22,"col":29}}],"kind":"term","permissions":["U {\n    left: =x;\n    right: =y\n  }","=/x_6"]},"6":{"names":[["auto","/x_1"]],"locations":[{"start":{"line":18,"col":12},"end":{"line":18,"col":18}}],"kind":"term","permissions":["True","=/x_1"]},"8":{"names":[["user","y"]],"locations":[{"start":{"line":21,"col":11},"end":{"line":21,"col":13}},{"start":{"line":21,"col":8},"end":{"line":21,"col":10}}],"kind":"term","permissions":["T","=y"]}},"dot":"digraph g {\ngraph [\n  rankdir = \"BT\"\n];\n\"node8\" [\n  id = \"node8\"\n  label = \"{{T}|y}\"\n  shape = \"record\"\n];\n\"node9\":left -> \"node5\" [\n];\n\"node9\":right -> \"node8\" [\n];\n\"node9\" [\n  id = \"node9\"\n  label = \"U|<left>left|<right>right\"\n  shape = \"record\"\n];\n\"node5\" [\n  id = \"node5\"\n  label = \"{{T}|x}\"\n  shape = \"record\"\n];\n}"}]}