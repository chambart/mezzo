{"syntax":"<div class=\"highlight\"><pre><span class=\"n\">data</span> <span class=\"kt\">bool</span> <span class=\"o\">=</span> <span class=\"nc\">True</span> <span class=\"o\">|</span> <span class=\"nc\">False</span>\n\n<span class=\"n\">exclusive</span> <span class=\"n\">data</span> <span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"nc\">T</span>\n<span class=\"n\">data</span> <span class=\"n\">u</span> <span class=\"o\">=</span> <span class=\"nc\">U</span> <span class=\"o\">{</span> <span class=\"n\">left</span><span class=\"o\">:</span> <span class=\"n\">t</span><span class=\"o\">;</span> <span class=\"n\">right</span><span class=\"o\">:</span> <span class=\"n\">t</span> <span class=\"o\">}</span>\n\n<span class=\"c\">(* Un exemple plus sophistiqué où l&#39;on cherche à conserver le partage dans</span>\n<span class=\"c\">   l&#39;environnement de retour. On obtient</span>\n\n<span class=\"c\">   ∃(? :: TERM). v2 @ U { left = ?; right = ? } ∗ ? @ T</span>\n<span class=\"c\">*)</span>\n<span class=\"k\">val</span> <span class=\"n\">v2</span> <span class=\"o\">=</span>\n  <span class=\"k\">if</span> <span class=\"n\">explain</span> <span class=\"nc\">True</span> <span class=\"k\">then</span> <span class=\"k\">begin</span>\n    <span class=\"k\">let</span> <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"nc\">T</span> <span class=\"k\">in</span>\n    <span class=\"nc\">U</span> <span class=\"o\">{</span> <span class=\"n\">left</span> <span class=\"o\">=</span> <span class=\"n\">x</span><span class=\"o\">;</span> <span class=\"n\">right</span> <span class=\"o\">=</span> <span class=\"n\">x</span> <span class=\"o\">}</span>\n  <span class=\"k\">end</span> <span class=\"k\">else</span> <span class=\"k\">begin</span>\n    <span class=\"k\">let</span> <span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"nc\">T</span> <span class=\"k\">in</span>\n    <span class=\"k\">let</span> <span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"nc\">T</span> <span class=\"k\">in</span>\n    <span class=\"nc\">U</span> <span class=\"o\">{</span> <span class=\"n\">left</span> <span class=\"o\">=</span> <span class=\"n\">y</span><span class=\"o\">;</span> <span class=\"n\">right</span> <span class=\"o\">=</span> <span class=\"n\">y</span> <span class=\"o\">}</span>\n  <span class=\"k\">end</span>\n</pre></div>\n","current_location":{"start":{"line":11,"col":8},"end":{"line":19,"col":5}},"file_name":"tests/merge2.hml","type":"merge","merged_env":{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"296pt\" height=\"134pt\"\n viewBox=\"0.00 0.00 296.00 134.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 130)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-130 293,-130 293,5 -4,5\"/>\n<!-- node4 -->\n<g id=\"node4\" class=\"node\"><title>node4</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 54,-44 54,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"27\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">bool</text>\n</g>\n<!-- node9 -->\n<g id=\"node9\" class=\"node\"><title>node9</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"113,-89 113,-125 167,-125 167,-89 113,-89\"/>\n<text text-anchor=\"middle\" x=\"140\" y=\"-102.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n</g>\n<!-- node5 -->\n<g id=\"node5\" class=\"node\"><title>node5</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"72,-8 72,-44 188,-44 188,-8 72,-8\"/>\n<text text-anchor=\"middle\" x=\"85.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">U</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"99,-8 99,-44 \"/>\n<text text-anchor=\"middle\" x=\"118.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">left</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"138,-8 138,-44 \"/>\n<text text-anchor=\"middle\" x=\"163\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">right</text>\n</g>\n<!-- node5&#45;&gt;node9 -->\n<g id=\"edge2\" class=\"edge\"><title>node5:left&#45;&gt;node9</title>\n<path fill=\"none\" stroke=\"black\" d=\"M118,-44C118,-56.0631 121.64,-68.7356 125.958,-79.5261\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"122.816,-81.076 130.03,-88.8352 129.229,-78.2707 122.816,-81.076\"/>\n</g>\n<!-- node5&#45;&gt;node9 -->\n<g id=\"edge4\" class=\"edge\"><title>node5:right&#45;&gt;node9</title>\n<path fill=\"none\" stroke=\"black\" d=\"M163,-44C163,-56.1239 159.195,-68.8078 154.68,-79.5903\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"151.404,-78.3382 150.423,-88.8876 157.769,-81.2524 151.404,-78.3382\"/>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"206,-1 206,-51 288,-51 288,-1 206,-1\"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"206,-26 288,-26 \"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v2</text>\n</g>\n</g>\n</svg>\n","root":5,"points":{"3":{"names":[["user","v2"]],"locations":[{"start":{"line":11,"col":4},"end":{"line":11,"col":7}}],"kind":"term","permissions":["=v2"]},"5":{"names":[["auto","merge_root10"]],"locations":[{"start":{"line":11,"col":8},"end":{"line":19,"col":5}}],"kind":"term","permissions":["U {\n    left: =merge_point12;\n    right: =merge_point12\n  }","U {\n    left: =merge_point12;\n    right: =merge_point12\n  }"]},"9":{"names":[["auto","merge_point12"],["auto","merge_point14"],["auto","merge_point13"],["auto","merge_point11"]],"locations":[{"start":{"line":13,"col":16},"end":{"line":14,"col":29}},{"start":{"line":17,"col":16},"end":{"line":18,"col":29}}],"kind":"term","permissions":["=merge_point12","T"]},"4":{"names":[["auto","v2_if"]],"locations":[{"start":{"line":12,"col":12},"end":{"line":12,"col":18}}],"kind":"term","permissions":["bool","True"]}},"dot":"digraph g {\ngraph [\n  rankdir = \"BT\"\n];\n\"node4\" [\n  id = \"node4\"\n  label = \"bool\"\n  shape = \"record\"\n];\n\"node9\" [\n  id = \"node9\"\n  label = \"T\"\n  shape = \"record\"\n];\n\"node5\":left -> \"node9\" [\n];\n\"node5\":right -> \"node9\" [\n];\n\"node5\" [\n  id = \"node5\"\n  label = \"U|<left>left|<right>right\"\n  shape = \"record\"\n];\n\"node3\" [\n  id = \"node3\"\n  label = \"{{unknown}|v2}\"\n  shape = \"record\"\n];\n}"},"sub_envs":[{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"296pt\" height=\"148pt\"\n viewBox=\"0.00 0.00 296.00 148.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 144)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-144 293,-144 293,5 -4,5\"/>\n<!-- node4 -->\n<g id=\"node4\" class=\"node\"><title>node4</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 54,-44 54,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"27\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node6 -->\n<g id=\"node6\" class=\"node\"><title>node6</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"113,-89 113,-139 167,-139 167,-89 113,-89\"/>\n<text text-anchor=\"middle\" x=\"140\" y=\"-122.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"113,-114 167,-114 \"/>\n<text text-anchor=\"middle\" x=\"140\" y=\"-97.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">x</text>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"206,-1 206,-51 288,-51 288,-1 206,-1\"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"206,-26 288,-26 \"/>\n<text text-anchor=\"middle\" x=\"247\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v2</text>\n</g>\n<!-- node7 -->\n<g id=\"node7\" class=\"node\"><title>node7</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"72,-8 72,-44 188,-44 188,-8 72,-8\"/>\n<text text-anchor=\"middle\" x=\"85.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">U</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"99,-8 99,-44 \"/>\n<text text-anchor=\"middle\" x=\"118.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">left</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"138,-8 138,-44 \"/>\n<text text-anchor=\"middle\" x=\"163\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">right</text>\n</g>\n<!-- node7&#45;&gt;node6 -->\n<g id=\"edge2\" class=\"edge\"><title>node7:left&#45;&gt;node6</title>\n<path fill=\"none\" stroke=\"black\" d=\"M118,-44C118,-55.8013 120.881,-68.2283 124.558,-79.2826\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"121.384,-80.7957 128.099,-88.9913 127.96,-78.3973 121.384,-80.7957\"/>\n</g>\n<!-- node7&#45;&gt;node6 -->\n<g id=\"edge4\" class=\"edge\"><title>node7:right&#45;&gt;node6</title>\n<path fill=\"none\" stroke=\"black\" d=\"M163,-44C163,-55.7526 160.038,-68.0855 156.239,-79.0684\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"152.852,-78.1286 152.577,-88.7199 159.397,-80.6121 152.852,-78.1286\"/>\n</g>\n</g>\n</svg>\n","root":7,"points":{"7":{"names":[["auto","/x_2"]],"locations":[{"start":{"line":13,"col":16},"end":{"line":14,"col":29}}],"kind":"term","permissions":["U {\n    left: =x;\n    right: =x\n  }","=/x_2"]},"3":{"names":[["user","v2"]],"locations":[{"start":{"line":11,"col":4},"end":{"line":11,"col":7}}],"kind":"term","permissions":["=v2"]},"6":{"names":[["user","x"]],"locations":[{"start":{"line":13,"col":11},"end":{"line":13,"col":13}},{"start":{"line":13,"col":8},"end":{"line":13,"col":10}}],"kind":"term","permissions":["T","=x"]},"4":{"names":[["auto","v2_if"]],"locations":[{"start":{"line":12,"col":12},"end":{"line":12,"col":18}}],"kind":"term","permissions":["True","=v2_if"]}},"dot":"digraph g {\ngraph [\n  rankdir = \"BT\"\n];\n\"node4\" [\n  id = \"node4\"\n  label = \"True\"\n  shape = \"record\"\n];\n\"node6\" [\n  id = \"node6\"\n  label = \"{{T}|x}\"\n  shape = \"record\"\n];\n\"node3\" [\n  id = \"node3\"\n  label = \"{{unknown}|v2}\"\n  shape = \"record\"\n];\n\"node7\":left -> \"node6\" [\n];\n\"node7\":right -> \"node6\" [\n];\n\"node7\" [\n  id = \"node7\"\n  label = \"U|<left>left|<right>right\"\n  shape = \"record\"\n];\n}"},{"svg":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.26.3 (20100126.1600)\n -->\n<!-- Title: g Pages: 1 -->\n<svg width=\"368pt\" height=\"148pt\"\n viewBox=\"0.00 0.00 368.00 148.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph1\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 144)\">\n<title>g</title>\n<polygon fill=\"white\" stroke=\"white\" points=\"-4,5 -4,-144 365,-144 365,5 -4,5\"/>\n<!-- node8 -->\n<g id=\"node8\" class=\"node\"><title>node8</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"41,-89 41,-139 95,-139 95,-89 41,-89\"/>\n<text text-anchor=\"middle\" x=\"68\" y=\"-122.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"41,-114 95,-114 \"/>\n<text text-anchor=\"middle\" x=\"68\" y=\"-97.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">y</text>\n</g>\n<!-- node4 -->\n<g id=\"node4\" class=\"node\"><title>node4</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"134,-8 134,-44 188,-44 188,-8 134,-8\"/>\n<text text-anchor=\"middle\" x=\"161\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">True</text>\n</g>\n<!-- node6 -->\n<g id=\"node6\" class=\"node\"><title>node6</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"206,-1 206,-51 260,-51 260,-1 206,-1\"/>\n<text text-anchor=\"middle\" x=\"233\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">T</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"206,-26 260,-26 \"/>\n<text text-anchor=\"middle\" x=\"233\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">z</text>\n</g>\n<!-- node9 -->\n<g id=\"node9\" class=\"node\"><title>node9</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-8 0,-44 116,-44 116,-8 0,-8\"/>\n<text text-anchor=\"middle\" x=\"13.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">U</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"27,-8 27,-44 \"/>\n<text text-anchor=\"middle\" x=\"46.5\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">left</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"66,-8 66,-44 \"/>\n<text text-anchor=\"middle\" x=\"91\" y=\"-21.9\" font-family=\"Times Roman,serif\" font-size=\"14.00\">right</text>\n</g>\n<!-- node9&#45;&gt;node8 -->\n<g id=\"edge2\" class=\"edge\"><title>node9:left&#45;&gt;node8</title>\n<path fill=\"none\" stroke=\"black\" d=\"M46,-44C46,-55.8013 48.881,-68.2283 52.5579,-79.2826\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"49.3842,-80.7957 56.0986,-88.9913 55.9605,-78.3973 49.3842,-80.7957\"/>\n</g>\n<!-- node9&#45;&gt;node8 -->\n<g id=\"edge4\" class=\"edge\"><title>node9:right&#45;&gt;node8</title>\n<path fill=\"none\" stroke=\"black\" d=\"M91,-44C91,-55.7526 88.0376,-68.0855 84.2391,-79.0684\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"80.8523,-78.1286 80.5767,-88.7199 87.3969,-80.6121 80.8523,-78.1286\"/>\n</g>\n<!-- node3 -->\n<g id=\"node3\" class=\"node\"><title>node3</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"278,-1 278,-51 360,-51 360,-1 278,-1\"/>\n<text text-anchor=\"middle\" x=\"319\" y=\"-34.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">unknown</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"278,-26 360,-26 \"/>\n<text text-anchor=\"middle\" x=\"319\" y=\"-9.4\" font-family=\"Times Roman,serif\" font-size=\"14.00\">v2</text>\n</g>\n</g>\n</svg>\n","root":9,"points":{"3":{"names":[["user","v2"]],"locations":[{"start":{"line":11,"col":4},"end":{"line":11,"col":7}}],"kind":"term","permissions":["=v2"]},"9":{"names":[["auto","/x_7"]],"locations":[{"start":{"line":17,"col":16},"end":{"line":18,"col":29}}],"kind":"term","permissions":["U {\n    left: =y;\n    right: =y\n  }","=/x_7"]},"6":{"names":[["user","z"]],"locations":[{"start":{"line":16,"col":11},"end":{"line":16,"col":13}},{"start":{"line":16,"col":8},"end":{"line":16,"col":10}}],"kind":"term","permissions":["T","=z"]},"4":{"names":[["auto","v2_if"]],"locations":[{"start":{"line":12,"col":12},"end":{"line":12,"col":18}}],"kind":"term","permissions":["True","=v2_if"]},"8":{"names":[["user","y"]],"locations":[{"start":{"line":17,"col":11},"end":{"line":17,"col":13}},{"start":{"line":17,"col":8},"end":{"line":17,"col":10}}],"kind":"term","permissions":["T","=y"]}},"dot":"digraph g {\ngraph [\n  rankdir = \"BT\"\n];\n\"node8\" [\n  id = \"node8\"\n  label = \"{{T}|y}\"\n  shape = \"record\"\n];\n\"node4\" [\n  id = \"node4\"\n  label = \"True\"\n  shape = \"record\"\n];\n\"node6\" [\n  id = \"node6\"\n  label = \"{{T}|z}\"\n  shape = \"record\"\n];\n\"node9\":left -> \"node8\" [\n];\n\"node9\":right -> \"node8\" [\n];\n\"node9\" [\n  id = \"node9\"\n  label = \"U|<left>left|<right>right\"\n  shape = \"record\"\n];\n\"node3\" [\n  id = \"node3\"\n  label = \"{{unknown}|v2}\"\n  shape = \"record\"\n];\n}"}]}