open pervasives
open list

val length [a] (xs : list a) : int =
  let c = newref 0 in
  let count (x: a | c @ ref int) : () =
    c := !c + 1
  in
  iter (count, xs);
  !c

