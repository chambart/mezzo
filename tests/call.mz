(* This program does not type-check. It seems to me that it should.
   I note that it does type-check if I add the hypothesis that [a]
   is duplicable. But I don't see why this hypothesis should be
   necessary? *)

val rec cps_iter [a] (
  consumes head: a,
  f: (
    consumes x: a,
    (| consumes (x @ a)) -> int
  ) -> int
) : int =
  f (
    head,
    fun (| consumes head @ a) : int = fail
  )

