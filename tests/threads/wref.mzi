abstract wref a
fact duplicable (wref a)

(* Allocation. *)

val newref: [a] (consumes x: a) -> wref a 

(* Atomic swap. *)

val swap: [a] (r: wref a, consumes x: a) -> a

(* Get. *)
(* BUG? The comparison between .mz and .mzi fails for [get]. *)
(*
val get: [a] duplicable a => wref a -> a
*)
(* Set. *)

val set: [a] (r: wref a, consumes newx: a) -> ()

