open core
open pervasives

mutable data tree k a =
  | Empty
  | Node { left: tree k a; key: k; value: a; right: tree k a; height: int }

val concat_or_join [k, a] (consumes t: Node { left: tree k a; key: k; value: option a; right: tree k a; height: unknown }) : tree k a =
  match t.value with
  | Some { value = d } -> (* BUG if I replace "contents" with "value", I get Assert_failure *)
      fail
  | None ->
      fail
  end

